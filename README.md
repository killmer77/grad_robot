# grad_robot
Prioritized Path Planning for 
Smart City Delivery Progress
Ritsumeikan University
Intelligent Robotic Systems Laboratory
Kang Haejoon
2600180372-6
I.Introduction
In the last few years, the use of robots to enhance productivity and automate tasks has seen a rapid rise due to the aging population and labor shortages in many areas. This is especially true for the transportation of goods and packages to various destinations, as the use of multiple self-driving robots has the potential to greatly increase efficiency. To ensure that robots can reach their intended destinations quickly, safely, and without interference from each other, research into multi-robot path planning is an important area in the field of robotics. This project aims to develop an automated multi-robot delivery system that can be used to transport goods and packages in a wide range of environments, including warehouses, factories, and distribution centers.
Using multiple robots in a delivery system can provide many advantages over a single traditional robot system. For example, a multi-robot system can increase the overall delivery capacity by allowing multiple robots to operate simultaneously. It also allows for greater flexibility, as the robots can be reconfigured or replaced as needed to account for changing delivery requirements. From a safety standpoint, this can reduce the need for human workers in potentially hazardous working environments.
Two major approaches are typically used in devising efficient path planning for multirobot: a centralized method, and a decentralized method. The centralized method is considered the most effective approach but can become difficult to manage as the number of robots increases. The decentralized method is better suited for sufficient to address specific scenarios of potential collisions. However, on the other hand, scenarios where the robots are operating in narrow environments such as corridors and warehouses, may not be sufficient.
II.Problem Statement
The project seeks to create a system that can work together autonomously, efficiently, and effectively to complete the delivery task. The use of multiple robots has the potential to increase delivery capacity by allowing multiple robots to operate simultaneously, as well as providing more flexibility through the ability to reconfigure or replace robots as needed. This can also reduce the need for human workers in potentially dangerous areas, thus improving safety.
Along with these advantages, there are a number of challenges to consider when developing automated multi-robot delivery systems. These include coordination and communication between robots, as well as the ability to adapt to changing environments and delivery requirements. To tackle these challenges, algorithms and control systems can be implemented to enable robots to collaborate effectively and achieve the desired results. Simulations can be used to test out different delivery scenarios and make sure the robots are able to adapt to any changes, as well as to provide an additional layer of safety and accuracy. Furthermore, the algorithms and control systems must be able to respond to unexpected situations, such as breakdowns on centralized networks or individual robots, in order to ensure that multiple robots can reach their destinations quickly and safely without interfering with each other.
To address this issue, path planning for multiple robots must be considered. It is a difficult problem that requires avoiding obstacles and efficiently utilizing resources to find the most optimal path for each robot to reach its destination. To address this challenge, this project introduces an approach for autonomous robot coordination called MultiRobot Routers (MRR). This approach is rooted in the prioritized planning algorithm, but also incorporates a collision resolver and a segmentation algorithm that take into account spatial and temporal constraints. It is designed to solve scenarios that are not solvable with the classical prioritized planning algorithm, while also providing faster computation times and an increased number of scenarios that can be solved. In addition, simulations can provide an additional layer of safety and accuracy, as they allow the robots to adjust their paths in real time in order to avoid any potential obstacles or hazards.
III.Tools
This project utilizes a variety of tools and algorithms to achieve its goal. The primary tool used is the Robot Operating System (ROS1), which is a powerful tool for path planning. In addition, RVIZ (Robot Visualization) is used to visualize the proposed path plan in 3D, and Librecad is used to read and render dxf files. The Raspberry Pi Mouse v3 is a programmable robot that can be programmed in Python, C++, and Scratch, while Gazebo could be added to used to simulate complex environments and scenarios with multiple robots.
ROS1 is a powerful tool used for path planning that has several advantages over other solutions. The main advantage is its effectiveness in planning the path quickly and accurately, which is why it has been given priority over other options. ROS1 is able to generate multiple path plans in a short amount of time, making it the ideal choice for path planning in the modern world.
RVIZ (Robot Visualization) is a powerful tool for path planning that allows users to visualize the proposed path plan in 3D. It allows for fast and reflexive path planning by giving users a live preview of the path plan and providing feedback on the progress of the plan. Additionally, RVIZ provides a set of tools for setting the priority of each path plan for the robots, allowing for high-level control of the path plan.
Librecad is a powerful open-source CAD software that can be used for path planning. It has the ability to read and render dxf files, which allows users to draw their own graphs and diagrams and use them for path planning.
Raspberry Pi Mouse v3 is a programmable robot. Based on the Raspberry Pi computer module, it can be programmed in Python, C++, and Scratch.
Gazebo is a powerful tool for path planning, allowing users to simulate complex environments and scenarios with multiple robots. It is a convenient and intuitive way to plan paths and test the actions of robots in various conditions before they are used in the real world. It has become a popular choice for robot path planning due to its flexibility and ease of use. When utilizing Gazebo, it will be expressed more neatly than RVIZ in the visual aspect of the project.
Multi-Robot Routers (MRR) are an approach to autonomous robot coordination that uses a priority planning algorithm and a crash resolver to create a deadlock-free environment. The segmentation algorithm works with manually created or automatically generated path segments, and the heuristic algorithms are tuned according to the map pattern and environment in which the robots operate. MRR is used to solve scenarios that cannot be solved by classical priority planning approaches.
As a result, Multi-robot routers (MRR) are an efficient approach to autonomous robot coordination. They utilize high-priority planning algorithms while considering spatial and temporal constraints, and can significantly increase the number of solved scenarios and reduce computational time. MRR also has crash resolvers and segmentation algorithms that can work with manually created or auto-generated path segments, allowing robots to execute plans in a distributed manner without centralized control.
Voronoi Path Graph is a data abstraction of a grid map, which is used to find paths for robots. It is generated using a Voronoi-distillation algorithm, which finds the maximum distance to all obstacles in the vicinity. The graph consists of maximum and minimum points, which are connected to form a fully connected path. This path is then segmented and used to generate a graph representation, which allows for the modeling of time complexity. This allows the planner to find solutions to potential deadlock problems and other issues such as avoiding robots at a crossing.
Multi Robot Collision Resolver (MRCR) is an important component of the Multi-Robot Router (MRR) algorithm proposed in this project. This algorithm is used to manage collisions between autonomous robots by finding alternative paths that avoid collisions with higher-priority robots. The MRCR takes spatial and temporal constraints into account and can handle scenarios such as wait(Backtracking Algorithm), avoid(Avoid Robot Algorithm), and push(Push Robot Algorithm). The MRCR is triggered when a higher-priority robot blocks a lower-priority one's path and searches for a path that avoids the other robot's path. This enables the router to find paths with minimal collisions and to better manage the flow of robots. Therefore, the MRCR is capable to find alternative paths without increasing the complexity of the system, allowing for the efficient coordination of multiple robots.
III-2.Algorithm
A-Star Algorithm is used in robot path planning to determine the optimal path between two points. It uses an evaluation function to estimate the cost of the path from the current node to the goal and combines it with the cost to reach the current node from the start node. The evaluation function takes into account the distance from the goal and any obstacles that may be present in the path.
Spatio-Temporal A-Star Algorithm is an improved version of the A-Star algorithm. It is used for multi-robot path planning and is designed to find specific goals in graphs. It is based on the A-Star algorithm, but there are a few additions. First, the path coordinator is used to store all planned path candidates and to restrict newly planned path candidates. This updates only if the potential of the vertex is not occupied by another robot. In addition, the MRCR module is used to verify that vertices are rejected due to robot collisions and to bypass collisions by extending the search graph. With these additions, the Spatio-Temporal A-Star algorithm becomes a powerful tool for multi-robot path planning.
Backtracking Algorithm (BTA) is a type of priority search used by multi-robot routers 
(MRR) to solve problems such as scenarios in which robots must wait for one another. To reduce time complexity, MRCR uses backtracking. This algorithm calculates the potential of the colliding robot at the collision vertex, then copies the vertex with the new potential. If the newly added vertex has an incorrect potential, it is backtracked again. The algorithm continues in this way until a valid solution is found or all possible solutions have been explored.
Avoid Robot Algorithm (AVRA) is a set of three different algorithms used to avoid higher prioritized robots in a Multi-Robot Router (MRR) environment.
The first algorithm, AVRCA (Avoid at Crossing), is used when the Spatio-Temporal A-
Star Algorithm finds a collision between robots and uses the BTA (Backtracking Algorithm) to resolve it. The robot will wait on the upper branch of the crossing and continue backtracking.
The second algorithm, AVRSA (Avoid at Start), is used when a robot is blocking a higher-prioritized robot's path candidate while sitting at its start point. The Potential Expander expands into all branches of the crossing to the right of the blocking robot and lets the blocking robot wait until the higher prioritized robot has passed.
The third algorithm, AVRGA (Avoid at Goal), is used when a robot has already reached its goal and blocks the path candidate of a higher-prioritized robot. In this case, the MRCR expands into the neighborhood that does not contain the start vertex and sets up a new goal sequence for the robot to wait on another vertex for the point in time when the higher prioritized robot has passed.
Push Robot Algorithm(PRA) is an approach used by Multi-Robot Routers (MRR) to coordinate autonomous robots. PRA is used to solve scenarios that cannot be solved using the Backtracking Algorithm (BTA) or Avoid Robot Algorithm (AVRA). For example, if one robot's goal is one vertex away from a crossing, the AVRA strategy fails. In this case, the MRCR can "push" in a waiting vertex in the moving direction of the higher prioritized robot. To do this, the Potential of the colliding robot in the vertex is calculated, and a vertex is copied to create a path candidate. If this vertex has a valid potential, it is added to the solution.
IV.Previous Progress
After conducting research on multi-robot using the RT robots, various research papers were studied, and their content were analyzed, and videos on several topics were watched to gain an understanding of the current state of research. It became clear that several topics were in interest, such as multi-robot path planning, navigation mapping, sensor data use, and deep learning. To further develop coding skills and knowledge in this field, basic courses on the platform "The Construction" were taken to learn about ROS and robotics. After further exploring the topics and analyzing the materials, two topics were identified as being the most relevant for the research: path planning and navigation mapping. Finally, interesting research papers related to these fields were focused on to delvelop deeper into the multi-robot research field and confirm the topic of the main research to path planning the multi-robot.
Eventually, through this process, research that could be emphasized in the future was identified. Therefore, the main paper for the research project is “Multi-Robot Path Planning (MRP): Extended spatial-temporal priority planning”. This is a study registered with ROS Wiki, and GitHub with codes published. There are some parts that are not completed yet, but it was good to understand while applying it because it was given with a well-written comment and available codes. To gain basic knowledge of robot code implementation and path planning, basic bits of knowledge were needed, so self-study of online classes of "ROS Basic" and "Path Planning Basics" using the "The Construct" platform was needed. In this studying understanding how to implement and execute basic code using ROS up to a certain level so the project could be understood was accomplished. Which contains several annotations and functions. Also, algorithms for path planning, the main focus of the research project, were studied. Understanding the Dijkstra Algorithm, which can measure the minimum distance, and the A* Search 
Algorithm, which is also used in current papers to search the minimum distance, were acquired. In addition, the Rapid-Exploiting Random Tree (RRT) was also studied for the development of future available projects.
V.Current Progress
Going through the process of executing the code to see if there were any problems with the project developed so far, downloading the packages and bases needed for a given code to the computer in the laboratory was started. The latest version of ROS-Noetic was downloaded to the computer, then the map server and the stage-ros package to run the current project were downloaded. LibrecCad, which can be used to draw map graphs used in the current project, was also downloaded. After connecting GitHub to the computer to use to download the code from GitHub and setting the SSH key, the code was able to be obtained using the terminal. Eventually, the project was able to be demonstrated and the arrival point of the multi-route in the project simulator was set. The current problem was discovered as it was implemented, and the future direction of development was able to be considered.
To ensure the project was developed to its fullest potential, further exploration and research were done to understand what steps would be necessary for further development. Various scenarios and plans to increase the direction of future development were brainstormed, as it is believed to be important to improve the basic understanding of how and what to develop the projects effectively. Even if the technologies are not being used in the current project, discovering and understanding the related fields, which could benefit the research in the future, was tried. Therefore, Gazebo, which is not implemented in the current project, was also learned to understand its potential and how it may be incorporated into the project. In addition, the composition and graph generation of map graphs using actual maps was looked at, and upgrading them to the next generation for the projects was considered. Whether it is possible to change the priority setting from the currently used method was also considered, as this may help improve the efficiency and accuracy of the project. All of the research done was aimed at helping the project reach its desired outcome and result.
 
Fig.1) Running the Code with 14 available robots.    Fig.2) Messages while running the Code
Organizing how to use the program is very important, which is why a demonstration program is given to learn how to run the code. The first step to setting up the program is to install ROS Noetic on a computer running Ubuntu 20.04. This will ensure the system is up-to-date and optimized for the project. Once that is complete, the second step is to download the project to be studied, which is essential to make sure the code is the most recent version and the project is configured correctly.
To interact with the project, the user will open the computer's terminal and connect to the project from the terminal. This will enable the user to use the project from the command line, a powerful way to control the project. The fourth step is to create a production compilation with catkin.make followed by sourcing source devel/setup.bash to run the file with the parameters: rosrun tuw_multi_robot_goal_generator goals_random 
_nr_of_robots:=32 _distance_boundary:=0.6 _distance_to_map_border:=0.2 
_nr_of_avaliable_robots:=14 . This code runs the 'tuw_multi_robot_goal_generator' program which generates random goals for multiple robots, with the parameters 
_nr_of_robots (number of robots) and _distance_boundary (distance between robots) set 
to 32 and 0.6, respectively, and parameters _distance_to_map_border:=0.2 (distance to the map border) and _nr_of_avaliable_robots (number of available robots) set to 0.2 and 14, respectively.
When RVIZ is launched [Fig.1] , if there are no errors, the Goal Selector can be activated in RVIZ to choose the target points for the robots on the set map. The Voronoi Graph with maximum and minimum distances will be automatically formed in RVIZ by the algorithms for the robots' target points, allowing the user to set the parameters for the robots and determine their movement. The robots will start to move according to the priority set by the Goal Selector, and the robot's status will be updated in real-time through messages [Fig.2], making it possible for the user to monitor the progress of the robots and ensure they are moving to the target points as expected.
It is essential to check for situations in which robots get stuck in deadlocks and for the codes to be unstable. One of the errors that occurred while executing the code is that if the code stops while it is running, the next time the code fails to execute. This is an important step to ensure the program is working as intended and any errors are addressed promptly. By following these steps, the users can have a successful path planning for multi-robot delivery progress.
VI.Future Progress
Investigating the framework for the problem statement is a critical step in any project development, as it helps to identify areas that can be improved or added to the project. Carefully constructing the problem statement will guide the project's development so that it is effective and efficient, aiming to achieve the desired outcomes. It is therefore essential to take the time to properly formulate the problem statement to ensure the success of the project.
The multi-robot automatic delivery function currently sets up its stations for all robots. Eventually, people could manually give objects or necessary supplies to robots located in stations, and they could deliver the goods by setting the goal selector as the target point. In addition, the priority of the current project can be considered as the priority of product delivery. However, would like to aim to make it possible to urgently change the priority in the direction of development. For example, there may be cases where the priority is behind the delivery process of one item to the target location. Therefore, it is necessary to add a function to change the priority in real-time so that it can select the minimum path and move ahead of other robots.
To achieve this, it is necessary to adjust the priority settings for multiple robots in the 
Multi-Robot Routing (MRR) system and set it in the form of the Backtracking Algorithm 
(BTA), Avoid Robot Algorithm (AVRA), Push Robot Algorithm(PRA) in the Multi-Robot Collision Resolver (MRCR) system to allow all other robots, other than the emergency robot, to avoid the emergency robot. This way, the emergency robot can quickly and efficiently traverse the shortest path. Moreover, it is also necessary to consider the overall arrival time and program execution time, since other robots will generate new paths when the emergency robots are set to the highest priority. However, in an automated environment, time minimization is a problem after implementing all processes efficiently, so we will exclude the process at this stage. Furthermore, it is important to consider the cost-effectiveness of emergency robots, since the priority settings will be of great influence in emergency control. Therefore, it is necessary to make sure that the emergency robots can be used with the highest efficiency by adjusting the priority settings in real-time.
VII.Reference
B. Binder, F. Beck, F. König and M. Bader, "Multi Robot Route Planning (MRRP): 
Extended Spatial-Temporal Prioritized Planning," 2019 IEEE/RSJ International Conference on Intelligent Robots and Systems (IROS), 2019, pp. 4133-4139, doi: 
10.1109/IROS40897.2019.8968465.
Binder, B. (2017). Spatio-temporal prioritized planning (Doctoral dissertation, Wien) 
FAKULTAT FUR INFORMATIK
Qi Wang, Marco Langerwisch, and Bernardo Wagner. Wide Range Global 
Path Planning for a Large Number of Networked Mobile Robots based on Generalized Voronoi Diagrams. IFAC Proceedings Volumes, 46(29):107 – 112, 2013.
![image](https://user-images.githubusercontent.com/40031793/233294760-c7dcf5f4-6ccc-40a4-b5da-7ad4f2a5a4a7.png)
